<Window
	x:Class="AxiomDrawApp.Views.MainWindow"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:localCtrl="clr-namespace:AxiomDrawApp.Views"
	xmlns:localVm="clr-namespace:AxiomDrawApp.ViewModel"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:wpfFramework="clr-namespace:Axiom.WpfFrameworks"
	Title="{Binding Title}"
	Width="800"
	Height="450"
	DataContext="{StaticResource MainViewModel}"
	WindowStartupLocation="CenterScreen"
	mc:Ignorable="d">
	<Window.Resources>
		<DataTemplate DataType="{x:Type wpfFramework:TooltipViewModel}">
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="auto" />
					<RowDefinition Height="auto" />
				</Grid.RowDefinitions>
				<TextBlock Text="{Binding Title}" />
				<TextBlock Grid.Row="1" Text="{Binding Description}" />
			</Grid>
		</DataTemplate>
		<DataTemplate DataType="{x:Type wpfFramework:CommandViewModel}">
			<Button Command="{Binding ExecuteCommand}" Style="{DynamicResource Button_Empty_Style}">
				<Grid>
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="auto" />
						<ColumnDefinition />
					</Grid.ColumnDefinitions>

					<TextBlock
						Grid.Column="1"
						MinWidth="100"
						Margin="8,0,8,0"
						VerticalAlignment="Center"
						Text="{Binding Title}" />
				</Grid>
			</Button>
		</DataTemplate>
	</Window.Resources>
	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="auto" />
			<RowDefinition />
			<RowDefinition Height="auto" />
		</Grid.RowDefinitions>

		<Menu Grid.Row="0" ItemsSource="{Binding Commands}">
			<Menu.Resources>

				<!--  Template generico per tutti i MenuItem  -->
				<Style x:Key="DynamicMenuItemStyle" TargetType="MenuItem">
					<!--  Header: nome della voce  -->
					<Setter Property="Header" Value="{Binding Title}" />

					<!--  Bambini: se è una categoria vengono mostrati  -->
					<Setter Property="ItemsSource" Value="{Binding Children}" />

					<!--  Se è un comando finale → associa il comando  -->
					<Setter Property="Command" Value="{Binding ExecuteCommand}" />
				</Style>

			</Menu.Resources>
			<Menu.ItemContainerStyle>
				<StaticResource ResourceKey="DynamicMenuItemStyle" />
			</Menu.ItemContainerStyle>
		</Menu>

		<localCtrl:Viewer2D
			Grid.Row="1"
			Padding="8"
			HorizontalAlignment="Stretch"
			VerticalAlignment="Stretch"
			BorderBrush="#FF9BA7B3"
			BorderThickness="1"
			CornerRadius="4"
			Document="{Binding Document}">
			<Border.Background>
				<LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
					<GradientStop Offset="0" Color="#FFE6EEF5" />
					<GradientStop Offset="0.5" Color="#FFD2DEE8" />
					<GradientStop Offset="1" Color="#FFBCCAD5" />
				</LinearGradientBrush>
			</Border.Background>
		</localCtrl:Viewer2D>
		<DataGrid Grid.Row="2" ItemsSource="{Binding Shapes}">
			<!--  Template dei dettagli della riga  -->
			<DataGrid.RowDetailsTemplate>
				<DataTemplate>
					<DataGrid
						Margin="0,4,0,4"
						AutoGenerateColumns="False"
						HeadersVisibility="Column"
						ItemsSource="{Binding Parameters}">
						<DataGrid.Columns>
							<DataGridTextColumn
								Binding="{Binding Name}"
								Header="Nome"
								IsReadOnly="True" />
							<DataGridTextColumn Binding="{Binding Value}" Header="Valore" />
						</DataGrid.Columns>
					</DataGrid>
				</DataTemplate>
			</DataGrid.RowDetailsTemplate>
			<DataGrid.RowDetailsVisibilityMode>
				VisibleWhenSelected
			</DataGrid.RowDetailsVisibilityMode>
		</DataGrid>
	</Grid>
</Window>
